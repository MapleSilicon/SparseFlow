# SparseFlow v0.3-alpha â€” GPU Compiler Pipeline

## Release Type
**Alpha / Architectural Milestone**

This release completes SparseFlow's **GPU lowering pipeline**, validating the compiler architecture from sparse analysis to GPU IR generation.

âš ï¸ **GPU kernels are stubs only** â€” no computation performed yet (by design).

---

## ğŸ¯ What's New

### End-to-End GPU Lowering
Complete MLIR pipeline from dense operations to GPU launch:
```
linalg.matmul (with N:M attributes)
  â†“ sparseflow-spa (static sparsity analysis)
Annotated sparse matmul
  â†“ sparseflow-rewrite-matmul
func.call @sparse_matmul_N_M
  â†“ sparseflow-gpu-rewrite
gpu.launch + gpu.module + gpu.func
```

### New Compiler Passes

- **`sparseflow-spa`** â€” Static N:M sparsity propagation
- **`sparseflow-rewrite-matmul`** â€” Rewrites sparse matmul to backend calls  
- **`sparseflow-gpu-rewrite`** â€” Lowers to GPU dialect IR

### Verified Capabilities

âœ… All passes load via MLIR plugin system  
âœ… Verifier-clean GPU IR generation  
âœ… Proper `gpu.module` + `gpu.func` + `gpu.launch` construction  
âœ… CPU runtime calls correctly consumed and replaced  

---

## ğŸ“‹ Known Limitations (By Design)

- GPU kernel body is empty stub (`gpu.return` only)
- No memory lowering or bufferization
- No GPU computation performed
- No performance claims

This is an **architectural checkpoint**, not a performance release.

---

## ğŸ”§ Usage
```bash
# Clone and build
git clone https://github.com/MapleSilicon/SparseFlow.git
cd SparseFlow/compiler/build
cmake -DCMAKE_PREFIX_PATH=/usr/lib/llvm-19 ..
make -j8

# Run GPU lowering pipeline
mlir-opt-19 \
  --load-pass-plugin=passes/SparseFlowPasses.so \
  --pass-pipeline="builtin.module(sparseflow-spa,sparseflow-rewrite-matmul,sparseflow-gpu-rewrite)" \
  input.mlir
```

---

## ğŸ“š Documentation

- [Architecture](ARCHITECTURE.md) â€” Compiler design overview
- [Release Notes](RELEASE_NOTES_v0.3_ALPHA.md) â€” Detailed changelog
- [Test README](compiler/tests/README.md) â€” Test methodology

---

## ğŸ—ºï¸ Roadmap

**v0.3-beta** (Next)
- GPU kernel ABI definition
- Memory layout for N:M patterns
- Thread/block mapping design

**v0.4** (Future)
- GPU sparse matmul implementation
- Bufferization support
- Performance validation

**v1.0** (Future)
- End-to-end optimized CPU + GPU backend
- Production-ready performance

---

## âš ï¸ Stability Notice

**Compiler:** Stable  
**Runtime:** CPU only (GPU is stub)  
**API:** Subject to change in beta

---

## ğŸ‘¥ Intended Audience

- MLIR compiler researchers
- GPU backend developers
- Sparse computation enthusiasts
- Hardware acceleration researchers

---

## ğŸ“ License

MIT

---

## ğŸ™ Acknowledgments

Built on MLIR/LLVM infrastructure.

Special thanks to the MLIR community for excellent documentation and tooling.
